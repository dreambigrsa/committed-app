(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[689],{856:function(e,t,s){Promise.resolve().then(s.bind(s,7955))},7955:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(7437),l=s(2265),n=s(9376),i=s(7648),r=s(1671),c=s(3388),d=s(7404),o=s(9388),x=s(1817),h=s(2611),m=s(8349),u=s(4223),p=s(6977),f=s(5398);function j(e){let{message:t,showOpenInApp:s=!0}=e,l=null!==(0,p.uA)();return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(r.Z,{className:"mx-auto h-16 w-16 text-emerald-500"}),(0,a.jsx)("h1",{className:"font-display text-xl font-bold text-slate-900",children:t}),(0,a.jsx)("p",{className:"text-slate-600",children:"You can now use the app to continue."}),s&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("a",{href:"".concat(p.EM,"sign-in"),className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-violet-600 px-6 py-3 font-semibold text-white hover:bg-violet-700",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5"}),"Open in App"]}),!l&&(0,a.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[(0,a.jsxs)("p",{className:"mb-3 flex items-center justify-center gap-2 text-sm font-medium text-slate-700",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),"Scan to open"]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(f.t,{value:"".concat(p.EM,"sign-in"),size:140,level:"M"})})]}),(0,a.jsx)(i.default,{href:"/download",className:"block text-center text-sm text-slate-600 hover:text-violet-600",children:"Don't have the app? Download it"})]})]})}function v(e){let{title:t,message:s,children:l}=e,n=null!==(0,p.uA)();return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(o.Z,{className:"mx-auto h-16 w-16 text-red-500"}),(0,a.jsx)("h1",{className:"font-display text-xl font-bold text-slate-900",children:t}),(0,a.jsx)("p",{className:"text-slate-600",children:s}),(0,a.jsxs)("div",{className:"space-y-3",children:[l,(0,a.jsxs)("a",{href:"".concat(p.EM,"sign-in"),className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-violet-600 px-6 py-3 font-semibold text-white hover:bg-violet-700",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5"}),"Open App"]}),!n&&(0,a.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[(0,a.jsxs)("p",{className:"mb-2 flex items-center justify-center gap-2 text-sm font-medium text-slate-700",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),"Scan to open"]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(f.t,{value:"".concat(p.EM,"sign-in"),size:120,level:"M"})})]}),(0,a.jsx)(i.default,{href:"/download",className:"block text-center text-sm text-slate-600 hover:text-violet-600",children:"Download the app"})]})]})}function y(){let e=(0,n.useSearchParams)(),t=(0,n.useRouter)(),[s,i]=(0,l.useState)("loading"),[r,c]=(0,l.useState)(""),[d,o]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),y=(0,l.useCallback)(async e=>{let t=u.GD.replace(/\/$/,""),s="".concat(t,"/verify-email?token=").concat(encodeURIComponent(e));try{let e=await fetch(s,{method:"GET",headers:{apikey:u.F3}}),t=await e.json().catch(()=>({}));i(!0===t.ok?"success":"error")}catch(e){i("error")}},[]);(0,l.useEffect)(()=>{let{type:s,token:a}=function(e,t){let s=e.get("type"),a=e.get("token")||e.get("access_token"),l=e.get("code");if(t){let e=new URLSearchParams(t.replace(/^#/,""));a=a||e.get("access_token")||e.get("token")}let n=null;if(t){let e=t.match(/access_token=([^&]+)/);e&&(n=decodeURIComponent(e[1]))}return{type:"verify"===s||"recovery"===s?s:null,token:a,code:l||null,access_token:n||e.get("access_token")}}(e,window.location.hash);if(!s||!a||a.length<16){i("no-params");return}if("recovery"===s){i("redirecting"),t.replace("/reset-password?token=".concat(encodeURIComponent(a)));return}"verify"===s&&y(a)},[e,t,y]);let g=async()=>{if(!r||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return;f(!0);let e=u.GD.replace(/\/$/,"");try{await fetch("".concat(e,"/send-verification"),{method:"POST",headers:{"Content-Type":"application/json",apikey:u.F3},body:JSON.stringify({email:r})})}catch(e){}o(!0),f(!1)};return"loading"===s||"redirecting"===s?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,a.jsx)(h.default,{}),(0,a.jsx)("main",{className:"mx-auto flex min-h-[60vh] max-w-md flex-col justify-center px-4 py-16",children:(0,a.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 shadow-xl text-center",children:[(0,a.jsx)(x.Z,{className:"mx-auto h-12 w-12 animate-spin text-violet-600"}),(0,a.jsx)("p",{className:"mt-4 text-slate-600",children:"redirecting"===s?"Taking you to set your password…":"Verifying…"})]})}),(0,a.jsx)(m.Z,{})]}):"no-params"===s?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,a.jsx)(h.default,{}),(0,a.jsx)("main",{className:"mx-auto flex min-h-[60vh] max-w-md flex-col justify-center px-4 py-16",children:(0,a.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 shadow-xl text-center",children:(0,a.jsx)(v,{title:"Invalid or expired link",message:"This link is missing information or has expired. Request a new link from the app."})})}),(0,a.jsx)(m.Z,{})]}):"success"===s?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,a.jsx)(h.default,{}),(0,a.jsx)("main",{className:"mx-auto flex min-h-[60vh] max-w-md flex-col justify-center px-4 py-16",children:(0,a.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 shadow-xl text-center",children:(0,a.jsx)(j,{message:"Email verified"})})}),(0,a.jsx)(m.Z,{})]}):"error"===s?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,a.jsx)(h.default,{}),(0,a.jsx)("main",{className:"mx-auto flex min-h-[60vh] max-w-md flex-col justify-center px-4 py-16",children:(0,a.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 shadow-xl text-center",children:(0,a.jsx)(v,{title:"Link invalid or expired",message:"This verification link is no longer valid. Request a new one below.",children:(0,a.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Resend verification email"}),(0,a.jsx)("input",{type:"email",placeholder:"Your email",value:r,onChange:e=>c(e.target.value),className:"mt-2 w-full rounded-lg border border-slate-300 px-4 py-2"}),(0,a.jsx)("button",{type:"button",onClick:g,disabled:p||!r,className:"mt-2 w-full rounded-lg bg-violet-600 px-4 py-2 text-sm font-semibold text-white hover:bg-violet-700 disabled:opacity-50",children:p?"Sending…":"Send"}),d&&(0,a.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:"If that email is registered, you'll receive a new link."})]})})})}),(0,a.jsx)(m.Z,{})]}):null}function g(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,a.jsx)(h.default,{}),(0,a.jsx)("main",{className:"mx-auto flex min-h-[60vh] max-w-md flex-col justify-center px-4 py-16",children:(0,a.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 shadow-xl text-center",children:[(0,a.jsx)(x.Z,{className:"mx-auto h-12 w-12 animate-spin text-violet-600"}),(0,a.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading…"})]})}),(0,a.jsx)(m.Z,{})]}),children:(0,a.jsx)(y,{})})}},7404:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])}},function(e){e.O(0,[216,937,553,673,971,117,744],function(){return e(e.s=856)}),_N_E=e.O()}]);